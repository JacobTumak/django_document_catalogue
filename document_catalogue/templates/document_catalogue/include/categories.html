{% load mptt_tags %}

{% recursetree categories %}
    <div class="dc-category-list panel panel-default">
        <div class="panel-heading">
            <table>
                <tr>
                    <td>
                        <h3 class="panel-title">
                            <a class="dc-category" href="{{ node.get_absolute_url }}">{{ node.name }}</a>
                        </h3>
                    </td>
                    {% if user_can_post_document %}
                        <td class="dc-dropzone"
                            title="Upload new document to {{ node.name }}"
                            data-dc-category="{{ node.slug }}" data-url="{% url 'document_catalogue:api_post' node.slug %}"
                        >
                            <span class="dz-message">Click or Drag-Drop here to upload files</span>
                        </td>
                    {% endif %}
                </tr>
            </table>
        </div>

        {% if show_documents and node.document_set.all|length > 0 %}
            <ul class="dc-document-list list-group">
                {% include "document_catalogue/include/documents.html" with document_list=node.document_set.all %}
            </ul>
        {% endif %}

        {% if not node.is_leaf_node %}
            <div class="panel-body">
                <div class="dc-category-children">
                    {{ children }}
                </div>
            </div>
        {% endif %}
    </div>
{% endrecursetree %}

